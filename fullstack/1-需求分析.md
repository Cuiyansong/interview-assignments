# 1-需求分析

## 1.1. 功能性需求

- 1.1.1. API接口：
  - 短域名存储接口：接受长域名信息，返回短域名信息
  - 短域名读取接口：接受短域名信息，返回长域名信息
- 1.1.2. 短域名
  - 短域名长度最大为 8 个字符（不含域名）

## 1.2. 预设需求指标

- [ ] 支持一定并发量QPS（创建短域名100qps, 获取长域名200qps）
- [ ] 存储容量考量
- [ ] 短域名缓存考量
- [ ] 读写分离，负载均衡

## 1.3. 功能设计

- 1.3.1. 长域名转换短域名，通过十进制自增id转换为62进制字符，并持久化
  - 自增唯一id生成器：基于`Reids`当前健数量作为起始值
  - 数据持续久化：`Redis`
  - 十进制转六十二进制函数：自定义函数
- 1.3.2. 通过短域名获取长域名
  - 存在，则重定向返回（301，不需要统计功能，再考虑负载性能，不使用302）
  - 不存在，则返回404
- 1.3.3. 使用Redis缓存已查询数据
- 1.3.4. 读写分离部署（1：2）
- 1.3.5. Nginx负载均衡请求

## 1.4. TODO
- [ ] 避免重复创建相同短域名
- [ ] 长域名最大2M字节长度校验

## 1.9. 参考
- [短链接、短网址使用的是什么算法-知乎](https://www.zhihu.com/question/20103344)
- [10进制转62进制](https://gist.github.com/kevinyan815/f71b2f5ca3541631abd2e50f3929739b)